"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{99671:function(le,C,a){a.r(C),a.d(C,{default:function(){return ae}});var R=a(17061),d=a.n(R),z=a(42122),h=a.n(z),$=a(17156),x=a.n($),E=a(27424),L=a.n(E),G=a(2618),r=a(85065);function W(p,i){return y.apply(this,arguments)}function y(){return y=x()(d()().mark(function p(i,g){return d()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,r.request)("/api/login/captcha",h()({method:"GET",params:h()({},i)},g||{})));case 1:case"end":return v.stop()}},p)})),y.apply(this,arguments)}var D=a(87547),B=a(94149),H=a(24454),V=a(61117),S=a(5966),w=a(16434),K=a(63434),Z=a(28906),Q=a(38925),A=a(45360),J=a(94740),X=a(71230),P=a(15746),Y=a(11941),T=a(67294),k=a(73935),q=a(67610),e=a(85893),ue=function(){var i=useEmotionCss(function(g){var m=g.token;return{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:m.colorPrimaryActive}}});return _jsxs(_Fragment,{children:[_jsx(AlipayCircleOutlined,{className:i},"AlipayCircleOutlined"),_jsx(TaobaoCircleOutlined,{className:i},"TaobaoCircleOutlined"),_jsx(WeiboCircleOutlined,{className:i},"WeiboCircleOutlined")]})},_=function(){var i=(0,Z.l)(function(g){var m=g.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:m.borderRadius,":hover":{backgroundColor:m.colorBgTextHover}}});return(0,e.jsx)("div",{className:i,"data-lang":!0,children:r.SelectLang&&(0,e.jsx)(r.SelectLang,{})})},N=function(i){var g=i.content;return(0,e.jsx)(Q.Z,{style:{marginBottom:24},message:g,type:"error",showIcon:!0})},ee=function(){var i=(0,T.useState)({}),g=L()(i,2),m=g[0],v=g[1],se=(0,T.useState)("account"),I=L()(se,2),M=I[0],re=I[1],b=(0,r.useModel)("@@initialState"),j=b.initialState,te=b.setInitialState,oe=(0,Z.l)(function(){return{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}),l=(0,r.useIntl)(),ne=function(){var c=x()(d()().mark(function n(){var u,o;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,j==null||(u=j.fetchUserInfo)===null||u===void 0?void 0:u.call(j);case 2:o=s.sent,o&&(0,k.flushSync)(function(){te(function(F){return h()(h()({},F),{},{currentUser:o})})});case 4:case"end":return s.stop()}},n)}));return function(){return c.apply(this,arguments)}}(),ie=function(){var c=x()(d()().mark(function n(u){var o,f,s,F;return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,G.x4)(h()(h()({},u),{},{type:M}));case 3:if(o=t.sent,o.status!=="ok"){t.next=12;break}return f=l.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),A.ZP.success(f),t.next=9,ne();case 9:return s=new URL(window.location.href).searchParams,r.history.push(s.get("redirect")||"/"),t.abrupt("return");case 12:console.log(o),v(o),t.next=21;break;case 16:t.prev=16,t.t0=t.catch(0),F=l.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(t.t0),A.ZP.error(F);case 21:case"end":return t.stop()}},n,null,[[0,16]])}));return function(u){return c.apply(this,arguments)}}(),U=m.status,O=m.type,de=function(){};return(0,e.jsx)(J.ZP,{theme:{token:{colorPrimary:"#000",borderRadius:2}},children:(0,e.jsxs)("div",{className:"page-login",children:[(0,e.jsx)(r.Helmet,{children:(0,e.jsxs)("title",{children:[l.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",q.Z.title]})}),(0,e.jsx)(_,{}),(0,e.jsx)("div",{className:"content",children:(0,e.jsxs)(X.Z,{children:[(0,e.jsx)(P.Z,{className:"left",span:12,children:"PiP\u901F\u94FE\u5168\u7403"}),(0,e.jsx)(P.Z,{className:"right",span:12,children:(0,e.jsxs)(V.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},initialValues:{autoLogin:!0},onFinish:function(){var c=x()(d()().mark(function n(u){return d()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,ie(u);case 2:case"end":return f.stop()}},n)}));return function(n){return c.apply(this,arguments)}}(),children:[(0,e.jsx)(Y.Z,{activeKey:M,onChange:re,centered:!0,items:[{key:"account",label:l.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"mobile",label:l.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})}]}),U==="error"&&O==="account"&&(0,e.jsx)(N,{content:l.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),M==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(D.Z,{})},placeholder:l.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(S.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(B.Z,{})},placeholder:l.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),U==="error"&&O==="mobile"&&(0,e.jsx)(N,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),M==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(H.Z,{})},name:"mobile",placeholder:l.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(w.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(B.Z,{})},captchaProps:{size:"large"},placeholder:l.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(n,u){return n?"".concat(u," ").concat(l.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):l.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var c=x()(d()().mark(function n(u){var o;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,W({phone:u});case 2:if(o=s.sent,o){s.next=5;break}return s.abrupt("return");case 5:A.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return s.stop()}},n)}));return function(n){return c.apply(this,arguments)}}()})]}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(K.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(r.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})})]})})]})})},ae=ee}}]);
